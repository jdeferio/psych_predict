import io
import SQL_Connect

def main():
        cursor = SQL_Connect.connect_DB()

        output_file = 'dx_ccw_other_algo.csv'

        sql = "select distinct co.condition_source_value, co.condition_concept_id, ct.concept_name from staging.condition_occurrence as co join staging.concept as ct on co.condition_concept_id = ct.concept_id where condition_source_value in ('ICD9CM:312.00', 'ICD9CM:312.01', 'ICD9CM:312.02', 'ICD9CM:312.03', 'ICD9CM:312.10', 'ICD9CM:312.11', 'ICD9CM:312.12', 'ICD9CM:312.13', 'ICD9CM:312.20', 'ICD9CM:312.21', 'ICD9CM:312.22', 'ICD9CM:312.23', 'ICD9CM:312.30', 'ICD9CM:312.31', 'ICD9CM:312.32', 'ICD9CM:312.33', 'ICD9CM:312.34', 'ICD9CM:312.35', 'ICD9CM:312.39', 'ICD9CM:312.4', 'ICD9CM:312.81', 'ICD9CM:312.82', 'ICD9CM:312.89', 'ICD9CM:312.9', 'ICD9CM:314.00', 'ICD9CM:314.01', 'ICD9CM:314.1', 'ICD9CM:314.2', 'ICD9CM:314.8', 'ICD9CM:314.9', 'ICD9CM:293.84', 'ICD9CM:300.00', 'ICD9CM:300.01', 'ICD9CM:300.02', 'ICD9CM:300.09', 'ICD9CM:300.10', 'ICD9CM:300.20', 'ICD9CM:300.21', 'ICD9CM:300.22', 'ICD9CM:300.23', 'ICD9CM:300.29', 'ICD9CM:300.3', 'ICD9CM:300.5', 'ICD9CM:300.89', 'ICD9CM:300.9', 'ICD9CM:308.0', 'ICD9CM:308.1', 'ICD9CM:308.2', 'ICD9CM:308.3', 'ICD9CM:308.4', 'ICD9CM:308.9', 'ICD9CM:309.81', 'ICD9CM:313.0', 'ICD9CM:313.1', 'ICD9CM:313.21', 'ICD9CM:313.22', 'ICD9CM:313.3', 'ICD9CM:313.82', 'ICD9CM:313.83', 'ICD9CM:299.0', 'ICD9CM:299.00', 'ICD9CM:299.01', 'ICD9CM:299.1', 'ICD9CM:299.11', 'ICD9CM:299.8', 'ICD9CM:299.80', 'ICD9CM:299.81', 'ICD9CM:299.9', 'ICD9CM:299.90', 'ICD9CM:299.91', 'ICD9CM:296.00', 'ICD9CM:296.01', 'ICD9CM:296.02', 'ICD9CM:296.03', 'ICD9CM:296.04', 'ICD9CM:296.05', 'ICD9CM:296.06', 'ICD9CM:296.10', 'ICD9CM:296.11', 'ICD9CM:296.12', 'ICD9CM:296.13', 'ICD9CM:296.14', 'ICD9CM:296.15', 'ICD9CM:296.16', 'ICD9CM:296.40', 'ICD9CM:296.41', 'ICD9CM:296.42', 'ICD9CM:296.43', 'ICD9CM:296.44', 'ICD9CM:296.45', 'ICD9CM:296.46', 'ICD9CM:296.50', 'ICD9CM:296.51', 'ICD9CM:296.52', 'ICD9CM:296.53', 'ICD9CM:296.54', 'ICD9CM:296.55', 'ICD9CM:296.56', 'ICD9CM:296.60', 'ICD9CM:296.61', 'ICD9CM:296.62', 'ICD9CM:296.63', 'ICD9CM:296.64', 'ICD9CM:296.65', 'ICD9CM:296.66', 'ICD9CM:296.7', 'ICD9CM:296.80', 'ICD9CM:296.81', 'ICD9CM:296.82', 'ICD9CM:296.89', 'ICD9CM:296.90', 'ICD9CM:296.99', 'ICD9CM:333.71', 'ICD9CM:343', 'ICD9CM:343.0', 'ICD9CM:343.1', 'ICD9CM:343.2', 'ICD9CM:343.3', 'ICD9CM:343.4', 'ICD9CM:343.8', 'ICD9CM:343.9', 'ICD9CM:243', 'ICD9CM:255.2', 'ICD9CM:269.2', 'ICD9CM:270.1', 'ICD9CM:270.2', 'ICD9CM:270.3', 'ICD9CM:270.4', 'ICD9CM:270.6', 'ICD9CM:270.7', 'ICD9CM:271.1', 'ICD9CM:277.0', 'ICD9CM:277.00', 'ICD9CM:277.01', 'ICD9CM:277.02', 'ICD9CM:277.03', 'ICD9CM:277.09', 'ICD9CM:277.6', 'ICD9CM:277.81', 'ICD9CM:277.85', 'ICD9CM:345', 'ICD9CM:345.0', 'ICD9CM:345.00', 'ICD9CM:345.01', 'ICD9CM:345.1', 'ICD9CM:345.10', 'ICD9CM:345.11', 'ICD9CM:345.2', 'ICD9CM:345.3', 'ICD9CM:345.4', 'ICD9CM:345.40', 'ICD9CM:345.41', 'ICD9CM:345.5', 'ICD9CM:345.50', 'ICD9CM:345.51', 'ICD9CM:345.6', 'ICD9CM:345.60', 'ICD9CM:345.61', 'ICD9CM:345.7', 'ICD9CM:345.70', 'ICD9CM:345.71', 'ICD9CM:345.8', 'ICD9CM:345.80', 'ICD9CM:345.81', 'ICD9CM:345.9', 'ICD9CM:345.90', 'ICD9CM:345.91', 'ICD9CM:338.2', 'ICD9CM:338.21', 'ICD9CM:338.22', 'ICD9CM:338.23', 'ICD9CM:338.29', 'ICD9CM:338.3', 'ICD9CM:338.4', 'ICD9CM:780.7', 'ICD9CM:780.71', 'ICD9CM:729.1', 'ICD9CM:729.2', 'ICD9CM:042', 'ICD9CM:042.0', 'ICD9CM:042.1', 'ICD9CM:042.2', 'ICD9CM:042.9', 'ICD9CM:043', 'ICD9CM:043.1', 'ICD9CM:043.2', 'ICD9CM:043.3', 'ICD9CM:043.9', 'ICD9CM:044', 'ICD9CM:044.0', 'ICD9CM:044.9', 'ICD9CM:079.53', 'ICD9CM:795.71', 'ICD9CM:317', 'ICD9CM:318', 'ICD9CM:318.0', 'ICD9CM:318.1', 'ICD9CM:318.2', 'ICD9CM:319', 'ICD9CM:758', 'ICD9CM:758.0', 'ICD9CM:758.1', 'ICD9CM:758.2', 'ICD9CM:758.3', 'ICD9CM:758.31', 'ICD9CM:758.32', 'ICD9CM:758.33', 'ICD9CM:758.39', 'ICD9CM:758.5', 'ICD9CM:759.7', 'ICD9CM:759.81', 'ICD9CM:759.83', 'ICD9CM:759.89', 'ICD9CM:760.71', 'ICD9CM:315', 'ICD9CM:315.01', 'ICD9CM:315.02', 'ICD9CM:315.09', 'ICD9CM:315.1', 'ICD9CM:315.2', 'ICD9CM:315.31', 'ICD9CM:315.32', 'ICD9CM:315.34', 'ICD9CM:315.35', 'ICD9CM:315.39', 'ICD9CM:315.4','ICD9CM:244.0', 'ICD9CM:244.1', 'ICD9CM:244.2', 'ICD9CM:244.3', 'ICD9CM:244.8', 'ICD9CM:244.9', 'ICD9CM:410.01', 'ICD9CM:410.11', 'ICD9CM:410.21', 'ICD9CM:410.31', 'ICD9CM:410.41', 'ICD9CM:410.51', 'ICD9CM:410.61', 'ICD9CM:410.71', 'ICD9CM:410.81', 'ICD9CM:410.91', 'ICD9CM:331.0', 'ICD9CM:331.11', 'ICD9CM:331.19', 'ICD9CM:331.2', 'ICD9CM:331.7', 'ICD9CM:290.0', 'ICD9CM:290.10', 'ICD9CM:290.11', 'ICD9CM:290.12', 'ICD9CM:290.13', 'ICD9CM:290.20', 'ICD9CM:290.21', 'ICD9CM:290.3', 'ICD9CM:290.40', 'ICD9CM:290.41', 'ICD9CM:290.42', 'ICD9CM:290.43', 'ICD9CM:294.0', 'ICD9CM:294.10', 'ICD9CM:294.11', 'ICD9CM:294.20', 'ICD9CM:294.21', 'ICD9CM:294.8', 'ICD9CM:797', 'ICD9CM:280.0', 'ICD9CM:280.1', 'ICD9CM:280.8', 'ICD9CM:280.9', 'ICD9CM:281.0', 'ICD9CM:281.1', 'ICD9CM:281.2', 'ICD9CM:281.3', 'ICD9CM:281.4', 'ICD9CM:281.8', 'ICD9CM:281.9', 'ICD9CM:282.0', 'ICD9CM:282.1', 'ICD9CM:282.2', 'ICD9CM:282.3', 'ICD9CM:282.40', 'ICD9CM:282.41', 'ICD9CM:282.42', 'ICD9CM:282.43', 'ICD9CM:282.44', 'ICD9CM:282.45', 'ICD9CM:282.46', 'ICD9CM:282.47', 'ICD9CM:282.49', 'ICD9CM:282.5', 'ICD9CM:282.60', 'ICD9CM:282.61', 'ICD9CM:282.62', 'ICD9CM:282.63', 'ICD9CM:282.64', 'ICD9CM:282.68', 'ICD9CM:282.69', 'ICD9CM:282.7', 'ICD9CM:282.8', 'ICD9CM:282.9', 'ICD9CM:283.0', 'ICD9CM:283.10', 'ICD9CM:283.11', 'ICD9CM:283.19', 'ICD9CM:283.2', 'ICD9CM:283.9', 'ICD9CM:284.01', 'ICD9CM:284.09', 'ICD9CM:284.11', 'ICD9CM:284.12', 'ICD9CM:284.19', 'ICD9CM:284.2', 'ICD9CM:284.81', 'ICD9CM:284.89', 'ICD9CM:284.9', 'ICD9CM:285.0', 'ICD9CM:285.1', 'ICD9CM:285.21', 'ICD9CM:285.22', 'ICD9CM:285.29', 'ICD9CM:285.3', 'ICD9CM:285.8', 'ICD9CM:285.9', 'ICD9CM:493.00', 'ICD9CM:493.01', 'ICD9CM:493.02', 'ICD9CM:493.10', 'ICD9CM:493.11', 'ICD9CM:493.12', 'ICD9CM:493.20', 'ICD9CM:493.21', 'ICD9CM:493.22', 'ICD9CM:493.81', 'ICD9CM:493.82', 'ICD9CM:493.90', 'ICD9CM:493.91', 'ICD9CM:493.92', 'ICD9CM:427.31', 'ICD9CM:600.00', 'ICD9CM:600.01', 'ICD9CM:600.10', 'ICD9CM:600.11', 'ICD9CM:600.20', 'ICD9CM:600.21', 'ICD9CM:600.3', 'ICD9CM:600.90', 'ICD9CM:600.91', 'ICD9CM:366.01', 'ICD9CM:366.02', 'ICD9CM:366.03', 'ICD9CM:366.04', 'ICD9CM:366.09', 'ICD9CM:366.10', 'ICD9CM:366.12', 'ICD9CM:366.13', 'ICD9CM:366.14', 'ICD9CM:366.15', 'ICD9CM:366.16', 'ICD9CM:366.17', 'ICD9CM:366.18', 'ICD9CM:366.19', 'ICD9CM:366.20', 'ICD9CM:366.21', 'ICD9CM:366.22', 'ICD9CM:366.23', 'ICD9CM:366.30', 'ICD9CM:366.45', 'ICD9CM:366.46', 'ICD9CM:366.50', 'ICD9CM:366.51', 'ICD9CM:366.52', 'ICD9CM:366.53', 'ICD9CM:366.8', 'ICD9CM:366.9', 'ICD9CM:379.26', 'ICD9CM:379.31', 'ICD9CM:379.39', 'ICD9CM:743.30', 'ICD9CM:743.31', 'ICD9CM:743.32', 'ICD9CM:743.33', 'ICD9CM:016.00', 'ICD9CM:016.01', 'ICD9CM:016.02', 'ICD9CM:016.03', 'ICD9CM:016.04', 'ICD9CM:016.05', 'ICD9CM:016.06', 'ICD9CM:095.4', 'ICD9CM:189.0', 'ICD9CM:189.9', 'ICD9CM:223.0', 'ICD9CM:236.91', 'ICD9CM:249.40', 'ICD9CM:249.41', 'ICD9CM:250.40', 'ICD9CM:250.41', 'ICD9CM:250.42', 'ICD9CM:250.43', 'ICD9CM:271.4', 'ICD9CM:274.10', 'ICD9CM:283.11', 'ICD9CM:403.01', 'ICD9CM:403.11', 'ICD9CM:403.91', 'ICD9CM:404.02', 'ICD9CM:404.03', 'ICD9CM:404.12', 'ICD9CM:404.13', 'ICD9CM:404.92', 'ICD9CM:404.93', 'ICD9CM:440.1', 'ICD9CM:442.1', 'ICD9CM:572.4', 'ICD9CM:580.0', 'ICD9CM:580.4', 'ICD9CM:580.81', 'ICD9CM:580.89', 'ICD9CM:580.9', 'ICD9CM:581.0', 'ICD9CM:581.1', 'ICD9CM:581.2', 'ICD9CM:581.3', 'ICD9CM:581.81', 'ICD9CM:581.89', 'ICD9CM:581.9', 'ICD9CM:582.0', 'ICD9CM:582.1', 'ICD9CM:582.2', 'ICD9CM:582.4', 'ICD9CM:582.81', 'ICD9CM:582.89', 'ICD9CM:582.9', 'ICD9CM:583.0', 'ICD9CM:583.1', 'ICD9CM:583.2', 'ICD9CM:583.4', 'ICD9CM:583.6', 'ICD9CM:583.7', 'ICD9CM:583.81', 'ICD9CM:583.89', 'ICD9CM:583.9', 'ICD9CM:584.5', 'ICD9CM:584.6', 'ICD9CM:584.7', 'ICD9CM:584.8', 'ICD9CM:584.9', 'ICD9CM:585.1', 'ICD9CM:585.2', 'ICD9CM:585.3', 'ICD9CM:585.4', 'ICD9CM:585.5', 'ICD9CM:585.6', 'ICD9CM:585.9', 'ICD9CM:586', 'ICD9CM:587', 'ICD9CM:588.0', 'ICD9CM:588.1', 'ICD9CM:588.81', 'ICD9CM:588.89', 'ICD9CM:588.9', 'ICD9CM:591', 'ICD9CM:753.12', 'ICD9CM:753.13', 'ICD9CM:753.14', 'ICD9CM:753.15', 'ICD9CM:753.16', 'ICD9CM:753.17', 'ICD9CM:753.19', 'ICD9CM:753.20', 'ICD9CM:753.21', 'ICD9CM:753.22', 'ICD9CM:753.23', 'ICD9CM:753.29', 'ICD9CM:794.4', 'ICD9CM:296.20', 'ICD9CM:296.21', 'ICD9CM:296.22', 'ICD9CM:296.23', 'ICD9CM:296.24', 'ICD9CM:296.25', 'ICD9CM:296.26', 'ICD9CM:296.30', 'ICD9CM:296.31', 'ICD9CM:296.32', 'ICD9CM:296.33', 'ICD9CM:296.34', 'ICD9CM:296.35', 'ICD9CM:296.36', 'ICD9CM:296.51', 'ICD9CM:296.52', 'ICD9CM:296.53', 'ICD9CM:296.54', 'ICD9CM:296.55', 'ICD9CM:296.56', 'ICD9CM:296.60', 'ICD9CM:296.61', 'ICD9CM:296.62', 'ICD9CM:296.63', 'ICD9CM:296.64', 'ICD9CM:296.65', 'ICD9CM:296.66', 'ICD9CM:296.89', 'ICD9CM:298.0', 'ICD9CM:300.4', 'ICD9CM:311', 'ICD9CM:249.00', 'ICD9CM:249.01', 'ICD9CM:249.10', 'ICD9CM:249.11', 'ICD9CM:249.20', 'ICD9CM:249.21', 'ICD9CM:249.30', 'ICD9CM:249.31', 'ICD9CM:249.40', 'ICD9CM:249.41', 'ICD9CM:249.50', 'ICD9CM:249.51', 'ICD9CM:249.60', 'ICD9CM:249.61', 'ICD9CM:249.70', 'ICD9CM:249.71', 'ICD9CM:249.80', 'ICD9CM:249.81', 'ICD9CM:249.90', 'ICD9CM:249.91', 'ICD9CM:250.00', 'ICD9CM:250.01', 'ICD9CM:250.02', 'ICD9CM:250.03', 'ICD9CM:250.10', 'ICD9CM:250.11', 'ICD9CM:250.12', 'ICD9CM:250.13', 'ICD9CM:250.20', 'ICD9CM:250.21', 'ICD9CM:250.22', 'ICD9CM:250.23', 'ICD9CM:250.30', 'ICD9CM:250.31', 'ICD9CM:250.32', 'ICD9CM:250.33', 'ICD9CM:250.40', 'ICD9CM:250.41', 'ICD9CM:250.42', 'ICD9CM:250.43', 'ICD9CM:250.50', 'ICD9CM:250.51', 'ICD9CM:250.52', 'ICD9CM:250.53', 'ICD9CM:250.60', 'ICD9CM:250.61', 'ICD9CM:250.62', 'ICD9CM:250.63', 'ICD9CM:250.70', 'ICD9CM:250.71', 'ICD9CM:250.72', 'ICD9CM:250.73', 'ICD9CM:250.80', 'ICD9CM:250.81', 'ICD9CM:250.82', 'ICD9CM:250.83', 'ICD9CM:250.90', 'ICD9CM:250.91', 'ICD9CM:250.92', 'ICD9CM:250.93', 'ICD9CM:357.2', 'ICD9CM:362.01', 'ICD9CM:362.02', 'ICD9CM:362.03', 'ICD9CM:362.04', 'ICD9CM:362.05', 'ICD9CM:362.06', 'ICD9CM:366.41')"

        cursor.execute(sql)

        with io.open(output_file, 'w', encoding='utf-8') as f:
            for index, row in enumerate(cursor):
                print(index)
                condition_source_value = str(row[0])
                condition_concept_id = str(row[1])
                concept_name = str(row[2])

                line = ','.join(
                    [condition_source_value, condition_concept_id, concept_name])

                f.write(line + '\n')

        print("Finished Reading!")

if __name__=='__main__':
    main()